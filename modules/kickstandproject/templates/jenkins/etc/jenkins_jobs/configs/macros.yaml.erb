- builder:
    name: gerrit-git-prep
    builders:
      - shell: "/usr/local/jenkins/slave_scripts/gerrit-git-prep.sh review.kickstand-project.org"

- builder:
    name: docs
    builders:
      - shell: "set -o pipefail ; tox -v -evenv -- python setup.py build_sphinx | tee sphinx.txt ; set +o pipefail"

- builder:
    name: pep8
    builders:
      - shell: "set -o pipefail ; tox -v -epep8 | tee pep8.txt ; set +o pipefail"

- builder:
    name: pyflakes
    builders:
      - shell: "tox -v -epyflakes"

- builder:
    name: puppet-lint
    builders:
      - shell: "rake lint"

- builder:
    name: puppet-spec
    builders:
      - shell: "rake spec"

- builder:
    name: puppet-syntax
    builders:
      - shell: |
          find . -iname *.pp | xargs puppet parser validate --modulepath=`pwd`/modules
          for f in `find . -iname *.erb` ; do
            erb -x -T '-' $f | ruby -c
          done

- builder:
    name: python27
    builders:
      - shell: "set -o pipefail ; tox -v -epy27 | tee py27.txt ; set +o pipefail"

- publisher:
    name: pep8
    publishers:
      - violations:
          pep8:
            min: 0
            max: 1
            unstable: 1
            pattern: '**/pep8.txt'

